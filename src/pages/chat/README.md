# AI测评聊天页面

这是一个功能完整的AI聊天界面，专门用于学习测评和智能对话。

## 🎯 功能特性

### 1. 聊天界面
- **经典聊天布局**：左右对齐的消息气泡
- **用户头像**：显示当前登录用户头像
- **AI头像**：生动的机器人表情 🤖
- **消息时间**：显示发送时间

### 2. 输入功能
- **文本输入**：支持多行文本输入
- **语音录制**：点击麦克风按钮录音
- **功能菜单**：点击"+"按钮展开：
  - 选择图片
  - 拍照
  - 上传文件

### 3. AI响应
- **打字机效果**：逐字显示AI回复
- **Markdown支持**：
  - 标题（# ## ###）
  - 粗体（**文本**）
  - 斜体（*文本*）
  - 行内代码（`代码`）
  - 代码块（```语言）
  - 列表（• - *）
- **流式响应**：支持实时流式数据
- **中断恢复**：提供"继续聊天"按钮

### 4. 交互功能
- **长按消息**：复制内容、重新发送
- **清空聊天**：点击顶部垃圾桶图标
- **返回首页**：点击左上角返回按钮

## 🛠️ 技术实现

### 组件结构
```
chat/
├── chat.tsx          # 主聊天组件
├── chat.css          # 聊天样式
└── README.md         # 说明文档

components/
└── MarkdownRenderer/
    ├── MarkdownRenderer.tsx  # Markdown渲染器
    └── MarkdownRenderer.css  # Markdown样式
```

### 核心功能

#### 1. 消息管理
```typescript
interface Message {
  id: string
  type: 'user' | 'ai'
  content: string
  timestamp: number
  isTyping?: boolean
  isComplete?: boolean
  attachments?: Array<{
    type: 'image' | 'file'
    url: string
    name?: string
  }>
}
```

#### 2. 打字机效果
- 动态调整打字速度
- 标点符号后停顿
- 自动滚动到底部

#### 3. Markdown渲染
- 支持常用Markdown语法
- 代码块水平滚动
- 响应式设计

#### 4. API集成
- 使用统一API配置
- 支持流式响应
- 错误处理和重试

## 📱 使用方法

### 1. 从首页进入
点击首页"开始测评"功能卡片即可进入聊天页面。

### 2. 发送消息
- 在底部输入框输入文本
- 点击发送按钮或按回车发送
- 支持多行文本输入

### 3. 语音输入
- 点击麦克风按钮开始录音
- 再次点击停止录音
- 自动识别语音并发送

### 4. 发送图片
- 点击"+"按钮
- 选择"选择图片"或"拍照"
- 图片会自动上传并发送

### 5. 消息操作
- 长按消息气泡可复制内容
- 长按用户消息可重新发送
- 点击顶部垃圾桶可清空聊天

## 🎨 样式特点

### 1. 现代化设计
- 渐变背景
- 毛玻璃效果
- 圆角设计
- 阴影效果

### 2. 动画效果
- 消息淡入动画
- 打字指示器
- 按钮点击反馈
- AI头像跳动

### 3. 响应式布局
- 适配不同屏幕尺寸
- 移动端优化
- 横屏支持

## 🔧 配置说明

### 1. API配置
聊天功能使用统一的API配置系统：
```typescript
// 在 config/api.ts 中配置
CHAT_SEND_MESSAGE: `${API_CONFIG.baseUrl}/api/chat/sendMessageStream`
```

### 2. 环境切换
可以通过修改 `config/env.ts` 切换开发/测试/生产环境。

### 3. 自定义样式
所有样式都在 `chat.css` 中，可以根据需要调整：
- 颜色主题
- 字体大小
- 间距布局
- 动画效果

## 🚀 扩展功能

### 1. 语音识别
当前使用模拟数据，可以集成真实的语音识别API。

### 2. 文件上传
支持上传各种类型的文件，可以扩展支持的文件格式。

### 3. 表情包
可以添加表情包选择功能。

### 4. 消息搜索
可以添加聊天记录搜索功能。

### 5. 聊天记录
可以实现聊天记录的本地存储和云端同步。

## 🐛 故障排除

### 1. 消息发送失败
- 检查网络连接
- 确认API服务器状态
- 查看控制台错误信息

### 2. 打字机效果异常
- 检查消息内容格式
- 确认组件状态更新
- 查看性能监控

### 3. Markdown渲染问题
- 检查Markdown语法
- 确认组件导入
- 查看样式冲突

### 4. 语音功能异常
- 检查麦克风权限
- 确认录音管理器初始化
- 查看平台兼容性

## 📝 开发注意事项

1. **性能优化**：大量消息时考虑虚拟滚动
2. **内存管理**：及时清理定时器和事件监听
3. **错误处理**：完善的错误提示和恢复机制
4. **用户体验**：流畅的动画和及时的反馈
5. **安全性**：输入内容的过滤和验证
