# 知识图谱管理 - 可编辑树形视图

## 功能概述

新增了可编辑的树形视图功能，允许用户直接在树形图上进行知识图谱的编辑操作，大大提升了用户体验。

## 主要功能

### 1. 直接编辑节点
- 点击节点旁边的操作按钮，选择"编辑"
- 节点会变为编辑模式，可以直接修改：
  - 节点名称
  - 难度等级（初级/中级/高级/专家）
  - 预估学习时长
- 点击"保存"确认修改，点击"取消"放弃修改

### 2. 添加子节点
- 点击任意节点的操作按钮，选择"添加子节点"
- 弹出添加节点对话框，填写：
  - 节点编码（必填）
  - 节点名称（必填）
  - 节点类型（层级节点/叶子节点）
  - 难度等级（必填）
  - 预估时长（必填）
  - 描述（可选）

### 3. 删除节点
- 点击节点的操作按钮，选择"删除"
- 确认删除操作
- 注意：只能删除没有子节点的节点

### 4. 拖拽移动节点
- 支持拖拽节点到新的位置
- 自动更新节点的父子关系和排序

### 5. 可视化展示
- 🎯 根节点图标
- 📁 层级节点图标  
- 📄 叶子节点图标
- 彩色标签显示难度等级：
  - 🟢 初级（绿色）
  - 🟠 中级（橙色）
  - 🔴 高级（红色）
  - 🟣 专家（紫色）
- 蓝色标签显示预估时长
- 鼠标悬停显示节点描述

## 技术实现

### 前端组件
- `EditableTree.tsx` - 可编辑树形组件
- 基于 Ant Design Tree 组件扩展
- 支持内联编辑、拖拽、右键菜单等交互

### 后端API
- `POST /api/admin/knowledge-map/updateNode` - 更新节点
- `POST /api/admin/knowledge-map/deleteNode` - 删除节点
- `POST /api/admin/knowledge-map/addNode` - 添加节点
- `POST /api/admin/knowledge-map/moveNode` - 移动节点

### 数据流
1. 获取技能树数据 → 转换为可编辑格式
2. 用户操作 → 调用相应API
3. 更新成功 → 刷新树形数据

## 使用方法

1. 在知识图谱管理页面，切换到"树形视图"标签
2. 选择要查看/编辑的技能树
3. 直接在树形图上进行各种编辑操作
4. 所有修改会实时保存到后端

## 优势

- **直观性**：可视化的树形结构，一目了然
- **便捷性**：直接在树上编辑，无需切换页面
- **实时性**：修改立即生效，实时反馈
- **交互性**：支持拖拽、内联编辑等丰富交互
- **安全性**：删除操作有确认提示，防止误操作

## 注意事项

- 删除节点前请确保该节点没有子节点
- 拖拽移动时注意不要形成循环引用
- 编辑时如果网络异常，请重新尝试操作
- 建议在编辑前先备份重要数据
