# 🧠 学习目标思维导图功能

## 📋 功能概述

在微信小程序的个人资料页面中，用户可以点击"我的学习目标"卡片来查看该学习目标的完整思维导图，帮助用户更直观地了解学习路径和知识结构。

## 🎯 功能特点

### 1. 交互触发
- **触发方式**：点击个人资料页面的"我的学习目标"卡片区域
- **前置条件**：用户必须已设置学习目标
- **导航方式**：平滑跳转到思维导图页面

### 2. 数据获取
- **API接口**：`POST /api/consumer/skill-catalog/tree`
- **请求参数**：
  ```json
  {
    "skillCode": "用户学习目标的技能编码",
    "treeStructure": true,
    "isActive": true
  }
  ```
- **数据转换**：将技能目录数据转换为思维导图节点格式

### 3. 可视化展示
- **只读模式**：用户只能查看，不能编辑
- **美观设计**：
  - 🎯 根节点：渐变背景，突出显示
  - 📁 层级节点：不同颜色区分层级
  - 📄 叶子节点：简洁清晰的展示
  - 🌈 连接线：彩色线条连接父子节点

### 4. 交互功能
- **手势缩放**：双指缩放查看不同细节层次
- **拖拽移动**：单指拖拽查看不同区域
- **节点详情**：点击节点查看详细信息（预留功能）

## 🎨 视觉设计

### 节点样式
```css
/* 根节点 */
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)

/* 层级节点 */
初级: linear-gradient(135deg, #52c41a, #389e0d)
中级: linear-gradient(135deg, #fa8c16, #d46b08)  
高级: linear-gradient(135deg, #f5222d, #cf1322)
专家: linear-gradient(135deg, #722ed1, #531dab)
```

### 页面布局
- **顶部导航**：返回按钮 + 学习目标标题 + 缩放比例
- **主要内容**：可滚动的Canvas画布
- **底部工具栏**：缩小、放大、重置按钮

## 🔧 技术实现

### 1. 页面结构
```
mindmap/
├── mindmap.tsx     # 主要组件逻辑
├── mindmap.css     # 样式文件
└── README.md       # 说明文档
```

### 2. 核心功能
- **数据获取**：调用后端API获取技能树数据
- **数据转换**：将技能目录格式转换为思维导图格式
- **Canvas绘制**：使用小程序Canvas API绘制思维导图
- **交互处理**：处理触摸事件实现缩放和拖拽

### 3. 状态管理
```typescript
const [skillTreeData, setSkillTreeData] = useState<SkillTreeData | null>(null)
const [loading, setLoading] = useState<boolean>(true)
const [error, setError] = useState<string>('')
const [scale, setScale] = useState<number>(1)
const [offsetX, setOffsetX] = useState<number>(0)
const [offsetY, setOffsetY] = useState<number>(0)
```

## 🚀 使用流程

### 1. 用户操作流程
1. 用户进入个人资料页面
2. 查看"我的学习目标"卡片
3. 点击卡片区域（非修改按钮）
4. 跳转到思维导图页面
5. 查看完整的学习路径图
6. 使用手势进行缩放和移动
7. 点击返回按钮回到个人资料页面

### 2. 数据流程
```
用户点击 → 获取学习目标编码 → 调用API → 数据转换 → 绘制思维导图
```

### 3. 错误处理
- **未登录**：提示用户先登录
- **未设置学习目标**：提示用户先设置学习目标
- **网络错误**：显示重试按钮
- **数据为空**：显示友好的空状态提示

## 📱 用户体验

### 1. 加载状态
- 显示加载动画和提示文字
- 背景使用渐变色保持视觉一致性

### 2. 错误状态
- 清晰的错误信息提示
- 提供重试按钮
- 保持页面布局稳定

### 3. 成功状态
- 流畅的思维导图展示
- 直观的操作提示
- 响应式的交互反馈

## 🎯 功能亮点

### 1. 直观性
- 树形结构清晰展示学习路径
- 颜色编码区分不同难度等级
- 节点大小反映内容重要性

### 2. 交互性
- 支持缩放查看不同层次细节
- 支持拖拽浏览大型思维导图
- 工具栏提供快捷操作

### 3. 美观性
- 现代化的渐变色设计
- 毛玻璃效果增强层次感
- 流畅的动画过渡效果

## 🔮 扩展功能

### 1. 节点详情
- 点击节点显示详细信息
- 包含学习资源链接
- 显示学习进度状态

### 2. 学习路径
- 高亮显示推荐学习路径
- 标记已完成和进行中的节点
- 提供学习建议

### 3. 分享功能
- 生成思维导图截图
- 分享到微信好友或朋友圈
- 导出为图片保存到相册

## 📊 性能优化

### 1. 渲染优化
- 使用Canvas进行高效绘制
- 实现视口裁剪减少绘制开销
- 节点位置计算缓存

### 2. 内存管理
- 及时清理Canvas上下文
- 避免内存泄漏
- 优化图片资源使用

### 3. 用户体验
- 加载状态友好提示
- 错误处理完善
- 操作响应及时

这个思维导图功能为用户提供了一个直观、美观、易用的学习路径查看工具，帮助用户更好地理解和规划自己的学习目标！🎉
